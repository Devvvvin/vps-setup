[INCLUDES]
before = common.conf

[Definition]
# ============================================================
# 规则1：基础认证失败（basic auth）
# Caddy error log → Docker json-file
# ============================================================
failregex = "log":".*\"logger\":\"http.log.error\".*\"msg\":\"basic auth: invalid credentials\".*\"remote_addr\":\"(?:<HOST>|\[(<HOST>)\]):\d+\""

# ============================================================
# 规则2：敏感路径扫描（403 / 404）
# /admin /wp-admin /config /database /api/v1/auth /phpmyadmin
# ============================================================
failregex = "log":".*\"uri\":\"/(admin|wp-admin|config|database|api/v1/auth|phpmyadmin)\".*\"status\":(403|404).*\"remote_addr\":\"(?:<HOST>|\[(<HOST>)\]):\d+\""

# ============================================================
# 规则3：通用扫描行为（高频 403 / 404）
# ⚠️ 建议只在 maxretry 较高时启用
# ============================================================
# failregex = "log":".*\"status\":(403|404).*\"remote_addr\":\"(?:<HOST>|\[(<HOST>)\]):\d+\""

# ============================================================
# 规则4：明显恶意请求（路径遍历 / SQLi / XSS）
# ============================================================
failregex = "log":".*\"uri\":\".*(\.\./|UNION SELECT|<script>).*\".*\"remote_addr\":\"(?:<HOST>|\[(<HOST>)\]):\d+\""

ignoreregex =
