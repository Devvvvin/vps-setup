[caddy-docker]
# ========== 基本配置 ==========
# 是否启用此 jail
enabled = true

# 保护的端口（服务名或端口号）
port = http,https

# ========== 日志监控 ==========
# 使用的 filter 名称
filter = caddy-docker

# 监控的日志文件路径（支持通配符）
logpath = /var/lib/docker/containers/*/*-json.log

# 日志文件编码
encoding = auto

# ========== 检测阈值 ==========
# 最大重试次数（超过此次数则封禁）
maxretry = 10

# 检测时间窗口（秒）- 10分钟内
findtime = 600

# 封禁时长（秒）- 1小时
bantime = 3600

# ========== 封禁动作 ==========
# 执行的动作
action = iptables-multiport[name=caddy-auth, port="http,https", protocol=tcp]

# ========== 高级配置（可选）==========
# 后端类型（auto, pyinotify, gamin, polling, systemd）
backend = auto